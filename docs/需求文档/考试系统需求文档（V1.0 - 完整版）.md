# 考试系统需求文档（V1.0 - 完整版）

## 1. 项目概述

### 1.1 项目目标

构建一套支持**在线组卷、定时考试、自动判分、防作弊、成绩统计**的全流程考试系统，满足学校、企业、培训机构等场景的标准化考试需求，实现 “从试卷创建到成绩分析” 的闭环管理。系统需具备高扩展性（支撑多题型扩展）、高安全性（细粒度权限 + 数据加密）、高可用性（并发支持 + 数据备份），适配 Java+Spring Security+Vue+MySQL 技术栈。

### 1.2 核心用户

|角色|核心诉求|典型操作场景|
| ---------------| -------------------------------------------------------------------------| ----------------------------------------------------------------------------------------------------------|
|考生|注册登录、查看考试通知、在线答题、提交试卷、查询成绩及错题解析|登录后查看 “计算机基础考试”→进入答题界面标记不确定题目→考试结束后查看错题解析|
|教师 / 出卷人|创建 / 导入题目、组卷、发布考试、设置考试规则、批改主观题、查看成绩报表|批量导入 “数学函数题”（含单选 / 填空 / 解答题）→用随机组卷生成 3 套难度一致试卷→批改主观题并填写评语|
|系统管理员|管理用户账号、分配角色权限、配置系统参数、备份数据、监控系统运行状态|创建 “阅卷教师” 角色并分配 “主观题批改” 权限→每日检查数据备份日志→处理考生账号异常反馈|

### 1.3 适用场景

- 学校：期中 / 期末线上考试（支持 500 人同时在线）、随堂测验（15-30 分钟短时效）、作业提交（支持拍照上传主观题答案）
- 企业：员工入职考核（关联岗位技能知识点）、技能认证（设置 “未通过重考间隔 7 天” 规则）、合规培训考试（强制学习后才能考试）
- 培训机构：学员阶段性测试（按知识点自动生成错题集）、证书考试（对接证书发放系统同步成绩）

## 2. 功能需求

### 2.1 用户管理模块

#### 2.1.1 账号管理

- 账号创建：
- 管理员操作：支持 Excel 批量导入（模板字段：姓名、账号、初始密码、角色 ID、所属组织 ID、手机号、邮箱），导入后初始密码为 “123456@Ab”，强制用户首次登录修改；支持单个创建（需填写所有必填字段，手机号 / 邮箱需校验唯一性）。
- 考生自主注册：注册页面填写 “姓名、手机号、邮箱、所属组织（下拉选择）”，手机号 / 邮箱接收验证码（6 位数字，有效期 5 分钟），提交后需管理员审核（审核通过系统自动发送激活通知，审核拒绝需填写拒绝原因）。
- 账号维护：
- 状态管理：管理员可设置账号 “启用 / 禁用”（禁用后账号无法登录，需填写禁用原因），支持批量禁用（如离职员工账号）。
- 信息修改：用户可修改 “姓名、手机号、邮箱”（修改手机号 / 邮箱需重新验证），管理员可修改所有用户信息（含所属组织、角色）。
- 密码管理：
- 密码加密：所有密码采用**Bcrypt 算法**存储（自动生成 10 位随机盐值，加密后字符串长度 60 位，不可逆）。
- 密码重置：考生通过 “忘记密码” 功能，凭手机号 / 邮箱接收验证码重置（新密码需满足 “8-20 位，含大小写字母 + 数字 + 特殊符号”）；管理员可强制重置用户密码（重置后为初始密码，系统自动发送通知）。

#### 2.1.2 权限控制

- 权限模型：基于**Spring Security 框架**实现 “角色 - 资源 - 操作” 三层 RBAC 模型，细粒度控制到 “按钮级” 操作：

|权限层级|定义|示例|
| ----------| -----------------------------| ----------------------------------------------------------------------------------------|
|角色级|预设 / 自定义角色，聚合权限|预设 “考生”“教师”“系统管理员”，自定义 “阅卷教师”“班级管理员”|
|资源级|按业务资源划分权限范围|“试卷资源” 权限（仅能查看自己创建的试卷）、“考生数据资源” 权限（仅能查看本班考生）|
|操作级|具体功能操作权限|“题目\_新增”“成绩\_导出”“考试\_终止”“选项\_修改”|

- 权限配置：
- 角色管理：管理员可创建新角色（需填写角色名称、描述，选择关联权限）、修改角色权限（支持批量添加 / 移除权限）、删除角色（仅允许删除自定义角色，预设角色不可删除）。
- 权限生效：基于 Spring Security 的 FilterChain 拦截所有请求，结合SecurityContextHolder存储用户权限信息，通过@PreAuthorize注解实现方法级权限校验（如@PreAuthorize("hasPermission(#examId, 'Exam', 'TERMINATE')")控制 “考试终止” 权限）。
- 权限审计：系统记录所有权限变更操作（操作人、操作时间、原权限、新权限、IP 地址），日志保留 1 年，支持按 “角色、操作人、时间” 筛选查询。

### 2.2 题库管理模块

#### 2.2.1 题目维护

- 题型支持：扩展 8 类题型，适配选项表存储逻辑，各类题型详细规则如下：

|题型分类|核心特征|选项存储需求|判分规则（自动判分场景）|
| -----------------------| -----------------------------------------------------------------------------| ----------------------------------------------------------------------------------------------| -------------------------------------------------------------------------------------------|
|单选题|4 个选项，仅 1 个正确|记录选项序号（A/B/C/D）、选项内容、是否正确（布尔值）、选项解析（可选）|考生选择与 “是否正确 \= true” 的选项一致，得满分；否则得 0 分|
|多选题|4-5 个选项，≥1 个正确|同单选题，支持多个 “是否正确 \= true” 的选项|考生选择与正确选项完全一致得满分；多选 / 少选 / 错选均得 0 分|
|不定项选择题|4 个选项，≥1 个正确，支持部分得分|记录选项序号、内容、是否正确、选项分值占比（如正确选项 A 占 50%，B 占 50%）|选对部分正确选项，按 “选项分值占比” 累加得分（如选对 A 得 50% 分）；选错任何选项得 0 分|
|判断题|2 个选项（对 / 错），仅 1 个正确|选项序号（对 / 错）、内容、是否正确，无选项解析|选择与正确选项一致得满分，否则 0 分|
|匹配题|左侧 “题干选项”（如 3 个）、右侧 “匹配选项”（如 3 个），一一对应|记录选项类型（题干 / 匹配）、关联标识（如 M1/M2，题干与匹配项关联同一标识）、内容|所有题干选项匹配正确得满分；每匹配正确 1 组得 1/N 分（N 为总组数）|
|排序题|3-5 个选项，需按正确顺序排列|记录选项序号、内容、正确排序值（如 1/2/3，代表正确顺序）|考生选择顺序与 “正确排序值” 完全一致得满分；采用 “逆序数法” 计算偏差，按偏差比例扣分|
|填空题|1-3 个空，每个空有固定答案（支持多个正确答案，如 “计算机 / 电脑” 均正确）|无选项，题目表中新增 “答案列表” 字段（存储多个正确答案，用 “|” 分隔）|
|主观题（简答 / 论述）|无固定选项，考生输入文本答案，需人工批改|无选项，题目表中新增 “参考答案”“评分标准” 字段（如 “答出 3 点得满分，少 1 点扣 3 分”）|教师按评分标准手动打分，支持输入得分（保留 1 位小数）和批改评语（限制 200 字以内）|

- 题目操作：
- 单个录入：教师进入 “题目新增页”，先选择题型（选择后动态展示对应字段），填写 “题目内容（支持富文本，插入图片 / 公式）、知识点（多选，最多 3 个）、难度（下拉选择易 / 中 / 难）、分值（默认 2 分，可修改）”，按题型填写选项 / 答案信息，提交后需管理员审核（审核通过才加入题库，审核拒绝需填写原因）。
- 批量导入：支持 Excel/Word 模板导入（提供模板下载，含必填字段说明），导入时系统校验：①字段格式（如分值为数字）、②选项规则（如单选题仅 1 个正确选项）、③内容非空，校验失败返回 “错误列表”（标注行号 + 错误原因），支持 “修正后重新导入”。
- 题目维护：支持 “编辑 / 删除 / 复制”（复制题目可快速生成相似题目，仅修改部分内容），删除题目需校验 “是否已被组卷”（已组卷题目仅允许 “禁用”，不可删除；未组卷题目可直接删除）。
- 题目查询：支持多条件筛选（题型、知识点、难度、创建时间、审核状态），支持模糊搜索（题目内容关键词），结果分页展示（默认 10 条 / 页，可切换 20/50 条），支持导出筛选结果（Excel 格式，含题目所有字段 + 关联选项信息）。

#### 2.2.2 题库分类

- 知识点分类：
- 层级结构：支持 3 级知识点分类（如 “计算机基础→硬件→CPU”），管理员可创建 / 修改 / 删除知识点（删除知识点需校验 “是否关联题目”，关联题目不可删除，需先迁移题目）。
- 权限隔离：不同组织（如 “XX 学校”“XX 企业”）的知识点分类相互独立，用户仅能查看所属组织的知识点。
- 题库隔离：基于 “所属组织 ID” 实现题库数据隔离，教师仅能查看 / 使用本组织的题目，管理员可跨组织查看题库（需开启 “跨组织查看” 权限）。

#### 2.2.3 选项表管理

- 选项维护：
- 关联操作：在 “题目编辑页” 中，按题型动态展示 “选项维护区域”（如单选题展示 4 个选项输入框，匹配题分 “题干选项”“匹配选项” 两栏），支持 “添加选项”（最多添加 10 个）、“删除选项”（至少保留 2 个，单选 / 多选题）、“调整选项顺序”（拖拽排序，同步更新选项序号）。
- 选项属性：
- 通用属性：选项序号（单选 / 多选为 A/B/C/D，排序题为 1/2/3，匹配题为题干 1 / 匹配 1）、选项内容（支持文本，匹配题 / 排序题支持插入图片）。
- 题型专属属性：单选题 / 多选题需勾选 “是否正确”；不定项选择题需填写 “分值占比”（如 50%，总和需为 100%）；匹配题需选择 “关联标识”（下拉选择已创建的标识，如 M1/M2）；排序题需填写 “正确排序值”（如 1，需唯一且连续）。
- 批量操作：支持 “复制选项”（从现有题目复制选项到当前题目，可选择复制 “全部选项” 或 “部分选项”）、“批量修改正确选项”（如多选题批量勾选多个正确选项）。
- 选项校验：系统实时校验选项规则，校验不通过禁止提交，具体规则如下：

|题型|校验规则|错误提示示例|
| --------------| ------------------------------------------------------------------------------------------| ----------------------------------------------------|
|单选题|必须且仅能选择 1 个 “正确选项”，选项总数≥2|“请选择 1 个正确选项，且至少添加 2 个选项”|
|多选题|至少选择 1 个 “正确选项”，选项总数≥2，最多选择 5 个选项|“请至少选择 1 个正确选项，选项数量不可超过 5 个”|
|不定项选择题|至少选择 1 个 “正确选项”，选项分值占比总和 \= 100%，且均为 10 的整数倍|“选项分值占比总和需为 100%，且仅支持 10 的倍数”|
|匹配题|题干选项与匹配选项的 “关联标识” 一一对应（如 M1 对应 1 个题干 + 1 个匹配项），总数相等|“关联标识 M1 缺少匹配选项，请补充”|
|排序题|正确排序值需唯一且连续（如 1、2、3，无重复 / 空缺），选项总数≥3|“正确排序值需连续且不重复，如 1、2、3”|

- 选项展示：教师端预览题目时，按题型展示选项（如匹配题分左右两栏，排序题展示拖拽图标）；考生端答题时，选项展示样式与题型适配（如单选为圆形单选框，多选为方形复选框）。

### 2.3 试卷管理模块

#### 2.3.1 组卷方式

- 固定组卷：
- 操作流程：教师进入 “固定组卷页”→填写试卷基本信息（名称、总分、及格线、所属知识点）→按题型筛选题目（如 “单选题 - 易 - 计算机基础”）→勾选题目（右侧实时展示已选题目列表，含题型、分值、难度）→调整每题分值（默认按题目预设分值，可修改，总分需与试卷总分一致）→预览试卷（查看题目顺序、选项展示）→保存为草稿 / 提交审核。
- 适用场景：随堂测验、作业（题目固定，便于统一讲解）。
- 随机组卷：
- 操作流程：教师进入 “随机组卷页”→填写试卷基本信息→设置组卷规则（按题型设置 “题量 + 难度分布 + 分值”，如 “单选题 10 道：易 3 道 ×2 分、中 5 道 ×2 分、难 2 道 ×3 分”）→选择题库范围（如 “仅本组织题库”“指定知识点题库”）→设置 “随机抽题去重规则”（如 “同一场考试考生试卷题目不重复”）→生成 “组卷模板”（可保存模板，后续复用）→预览样卷（系统随机生成 1 份样卷，展示规则匹配度）→保存为草稿 / 提交审核。
- 规则校验：组卷规则设置后，系统校验 “题库中符合条件的题目数量≥规则题量”（如规则需 10 道易单选题，题库仅 8 道则提示 “易单选题数量不足，请调整规则”）。
- 适用场景：期中 / 期末考试、认证考试（确保同批次考生试卷不同但难度一致，防作弊）。

#### 2.3.2 试卷属性与维护

- 试卷属性：
- 基础属性：试卷 ID（系统自动生成，如 P20251106001）、试卷名称（如 “2025 年秋季计算机基础期末试卷”）、组卷方式（固定 / 随机）、总分（默认 100 分，可修改为 50/150 分）、及格线（默认总分的 60%，可手动调整）、所属组织 ID、创建人 ID、创建时间、审核状态（草稿 / 待审核 / 已通过 / 已拒绝）、发布状态（未发布 / 已发布 / 已过期）。
- 扩展属性：允许查看错题解析（开启 / 关闭，默认关闭）、允许补考（开启 / 关闭，默认关闭）、补考次数限制（0-5 次，开启补考后需设置）、试卷有效期（发布后 N 天内有效，默认 30 天）。
- 试卷审核：
- 审核流程：教师提交试卷后，由管理员审核（审核内容：题目准确性、分值合理性、组卷规则有效性），审核通过后试卷状态变为 “已通过”（可发布）；审核拒绝需填写拒绝原因（如 “单选题第 5 题答案错误”），教师可修改后重新提交。
- 版本管理：试卷修改后生成新版本（版本号如 V1.1），保留历史版本（支持查看历史版本内容，不可修改），避免误操作导致数据丢失。
- 试卷发布：已通过审核的试卷，教师可 “立即发布” 或 “定时发布”（设置未来时间，系统自动发布），发布后试卷状态变为 “已发布”，考生可在试卷有效期内查看。

### 2.4 考试管理模块

#### 2.4.1 考试发布与配置

- 考试创建：
- 基础配置：教师进入 “考试创建页”→选择关联试卷（仅能选择 “已通过审核” 的试卷）→填写考试名称（如 “计算机基础期末考 - 高一（1）班”）、考试起止时间（开始时间需晚于当前时间，结束时间需晚于开始时间）、考试时长（30 分钟 - 3 小时，超时自动提交）、考试范围（指定考生 / 班级 / 组织，支持批量选择）。
- 答题规则配置：

|规则项|配置选项|默认值|
| --------------| -------------------------------------------------------------------| ---------|
|切屏检测|允许切屏次数（0-5 次），超过次数自动提交|3 次|
|切屏计时|切屏时长是否计入考试时间（是 / 否）|是|
|禁止复制粘贴|答题区域是否屏蔽复制 / 粘贴 / 剪切功能（是 / 否）|是|
|单设备登录|是否仅允许 1 台设备登录考试（是 / 否，开启后更换设备需重新验证）|是|
|主观题防抄袭|是否开启文本相似度检测（是 / 否，开启后需设置相似度阈值，如 80%）|否|
|考试提醒|考前 N 分钟短信 / 邮箱提醒（0-60 分钟，0 为不提醒）|15 分钟|

- 考试通知：考试发布后，系统自动推送通知至考生（系统内消息 + 短信 / 邮箱提醒，短信 / 邮箱需考生已绑定），通知内容含 “考试名称、开始时间、时长、进入考试的链接”。

#### 2.4.2 防作弊功能

- 切屏检测：
- 检测逻辑：基于浏览器visibilitychange事件监听页面切换，切屏时记录 “切屏时间、切屏次数”，超过配置次数（如 3 次）时，系统弹出提示 “切屏次数已达上限，将在 10 秒后自动提交试卷”，倒计时结束后强制提交。
- 异常处理：若因浏览器崩溃导致误判切屏，考生可联系管理员申请 “切屏次数重置”（管理员需核实日志后操作，仅允许重置 1 次）。
- 设备与登录控制：
- 单设备登录：考生登录考试后，系统记录设备唯一标识（如浏览器指纹 + IP 地址），若其他设备登录同一账号，当前设备考试页面自动锁定，需输入手机验证码解锁（防止代考）。
- 登录验证：考生进入考试前，需完成 “身份验证”（如填写身份证号后 4 位、人脸识别，可选配置），验证通过方可进入答题界面。
- 主观题防抄袭：
- 检测逻辑：考试结束后，系统对主观题答案进行文本相似度分析（基于余弦相似度算法），将相似度超过阈值（如 80%）的答案标记为 “疑似抄袭”，生成 “抄袭分析报告”（含考生姓名、相似度值、雷同答案片段），供教师复核。
- 处理方式：教师复核后可标记 “确认抄袭”（该题得 0 分，记录作弊行为）或 “排除抄袭”（正常判分）。

#### 2.4.3 考生答题流程

- 考试进入：
- 流程：考生登录系统→进入 “我的考试” 列表→找到 “进行中” 考试→点击 “进入考试”→阅读考试规则（需勾选 “已阅读并同意”）→完成身份验证（若配置）→进入答题界面。
- 超时限制：考试开始时间后 30 分钟内未进入考试，视为 “放弃考试”；考试结束前 30 分钟内不可再进入考试（防止考生仅答少量题目）。
- 答题界面：
- 界面布局：左侧 “题目列表”（显示题目序号、题型、答题状态：未答 / 已答 / 标记），中间 “答题区域”（按题型展示题目内容 + 选项 / 输入框，主观题支持富文本编辑，插入图片），右侧 “考试信息”（剩余时间、总分、已答题目数、标记题目数）。
- 核心操作：
- 标记题目：点击题目列表中的 “标记” 按钮，标记为 “不确定”（标记题目在列表中高亮显示，便于后续优先检查）。
- 切换题目：通过题目列表点击切换，或点击 “上一题 / 下一题” 按钮切换，切换时自动保存当前答题结果。
- 答题保存：客观题选择后实时保存，主观题每 30 秒自动保存（也可手动点击 “保存答案” 按钮），防止网络中断 / 浏览器崩溃导致数据丢失。
- 试卷提交：
- 手动提交：考生完成答题后，点击 “提交试卷”→系统弹出确认框（“确认提交？提交后不可修改”）→确认后提交，提交成功显示 “提交成功” 页面（含考试名称、提交时间）。
- 自动提交：考试时间结束时，系统自动保存所有答题结果并提交，提交前弹出 “时间即将结束，将自动提交” 提示（倒计时 10 秒）。
- 异常提交：网络中断时，考生重新登录后可恢复之前的答题进度（系统从 Redis 缓存中读取未提交数据），恢复后可继续答题或提交。

#### 2.4.4 考试监控与管理

- 考试监控：管理员 / 教师可进入 “考试监控页”，查看 “当前在线考生数、已提交人数、未提交人数、切屏异常人数”，支持查看单个考生的 “答题进度”（已答 / 未答题目数）、“切屏记录”（切屏时间、次数）、“登录设备信息”（设备标识、IP 地址、登录时间）。
- 考试操作：
- 紧急终止：考试过程中，若出现题目错误、系统异常等情况，管理员 / 教师可 “紧急终止” 考试（需填写终止原因），终止后所有考生的考试页面自动锁定，无法继续答题，已答题数据自动保存并提交。
- 考试延期：因特殊原因（如系统故障），管理员可延长考试时长（如延长 30 分钟）或调整考试结束时间，延长后系统自动通知所有未提交考生。
- 补考设置：对 “未参加考试”“考试不及格” 的考生，教师可手动开启补考（需在试卷补考次数限制内），补考考试配置与原考试一致，成绩以 “最高分为准” 或 “最新分为准”（教师可选择）。

### 2.5 成绩管理模块

#### 2.5.1 判分规则与执行

- 自动判分：
- 执行时机：考生提交试卷后，系统立即对客观题（单选 / 多选 / 判断 / 不定项 / 匹配 / 排序 / 填空）进行自动判分，判分结果实时存入 “答题记录表”，总分实时计算（客观题得分之和，主观题暂记 0 分）。
- 判分细节：
- 填空题：支持 “模糊匹配”（如答案为 “计算机”，考生输入 “电脑” 也视为正确），多个正确答案用 “|” 分隔，匹配任一即得分。
- 排序题：采用 “逆序数法” 计算偏差（如正确顺序为 1-2-3，考生选择 1-3-2，逆序数为 1，扣 50% 分）。
- 不定项选择题：按 “选项分值占比” 累加得分（如正确选项 A 占 50%、B 占 50%，考生选 A 得 50% 分）。
- 主观题批改：
- 批改流程：教师进入 “主观题批改页”→选择考试（仅显示 “已结束” 且 “未批改完成” 的考试）→按题目筛选（如 “简答题第 3 题”）→批量查看考生答案（支持左右分屏：左侧考生答案，右侧参考答案 + 评分标准）→输入得分（保留 1 位小数，需在 0 - 题目分值范围内）→填写评语（可选，限制 200 字）→提交批改，支持 “批量批改”（如 “所有答出 2 点的考生得 8 分”）。
- 批改状态：批改过程中，考试成绩状态分为 “未批改”（无主观题）、“部分批改”（部分主观题未批改）、“已完成”（所有主观题已批改），仅 “已完成” 状态下考生可查看成绩。
- 成绩校准：若批改后发现题目答案错误，教师可申请 “成绩重判”（需管理员审核），审核通过后系统重新计算所有考生的该题得分，更新总分，并重定向考生成绩页面。

#### 2.5.2 成绩查询与统计

- 考生成绩查询：
- 查询内容：考试 “已完成” 后，考生进入 “我的成绩” 列表，查看 “考试名称、总分、及格状态（及格 / 不及格）、答题时间、提交时间”，点击 “查看详情” 可查看 “每题得分、标准答案（客观题）、错题解析（若开启）、主观题批改评语”。
- 补考成绩：若有补考，列表显示 “原考成绩”“补考成绩”，标注 “最终成绩”（按教师设置的 “最高分 / 最新分” 规则）。
- 教师成绩统计：
- 成绩汇总：教师查看所管理考试的 “成绩汇总表”，包含 “参考人数、实考人数、缺考人数、平均分、最高分、最低分、及格率（总分≥及格线）、优秀率（总分≥80%）”，支持按 “班级 / 考生” 筛选统计。
- 分数段分布：以柱状图展示分数段分布（如 0-59 分、60-69 分、70-79 分、80-89 分、90-100 分），支持导出图表（PNG 格式）和数据（Excel 格式）。
- 题目分析：展示 “每题得分率”（该题平均得分 / 题目分值），按得分率排序，便于教师识别 “难点题目”（得分率 \< 50%），支持查看 “每题错误选项分布”（客观题）。
- 成绩导出：教师 / 管理员可导出 “考生成绩列表”（Excel 格式，含 “考生姓名、账号、所属班级、总分、及格状态、各题得分、答题时间、提交时间”），支持按 “及格状态、分数段” 筛选导出。

### 2.6 统计分析模块

#### 2.6.1 教师端分析报表

- 考试分析报表：
- 核心指标：参考率（实考人数 / 参考人数）、平均分偏差（本次考试平均分与历史同类型考试平均分对比）、知识点掌握率（各知识点题目平均得分率）、题型得分率（各题型平均得分率）。
- 可视化展示：用折线图展示 “知识点掌握率”，用饼图展示 “题型得分率占比”，支持查看 “各班级对比数据”（如高一（1）班平均分 vs 高一（2）班平均分）。
- 题目使用报表：展示教师创建的题目 “被组卷次数、被考试使用次数、平均得分率”，按 “使用次数” 排序，便于教师识别 “高频使用题目” 和 “低效题目”（得分率 \< 30%），优化题库。

#### 2.6.2 管理员端系统报表

- 系统运行报表：
- 核心数据：总用户数（按角色分类）、总题库量（按题型分类）、总试卷数（按状态分类）、总考试数（按状态分类）、本月活跃用户数（登录≥1 次）、本月考试参与人次。
- 趋势分析：用折线图展示 “近 30 天每日考试参与人次”“近 3 个月题库增长趋势”，支持查看 “系统资源占用率”（CPU 使用率、内存使用率、数据库磁盘占用）。
- 权限审计报表：展示 “近 30 天权限变更记录”（角色创建 / 修改、权限分配）、“越权访问记录”（如考生尝试调用 “删除题目” 接口），按 “操作人、时间” 筛选，便于管理员监控权限安全。

## 3. 非功能需求

### 3.1 性能需求

- 并发性能：
- 在线考试并发：同时在线考试人数≥500 人时，系统响应时间≤2 秒（答题操作、自动保存），页面加载时间≤3 秒，无卡顿、数据丢失。
- 批量操作性能：批量导入题目（≤1000 题）时间≤10 秒，批量批改主观题（≤500 份）时间≤15 秒，批量导出成绩（≤1000 条）时间≤5 秒。
- 数据处理性能：
- 自动判分：单场考试≤1000 人提交后，客观题判分完成时间≤30 秒，总分计算完成时间≤1 分钟。
- 报表生成：数据量≤10000 条时，成绩汇总报表生成时间≤3 秒，考试分析报表生成时间≤5 秒。
- 缓存性能：热门题目（近 7 天被组卷≥10 次）缓存命中率≥90%，缓存更新延迟≤10 秒（题目修改后）。

### 3.2 稳定性需求

- 系统可用性：
- 全年可用性≥99.9%（允许每年计划内维护时间≤8.76 小时），计划内维护需提前 24 小时通知用户。
- 故障恢复：系统崩溃后，服务恢复时间≤10 分钟，数据恢复时间≤5 分钟（基于最新备份）。
- 数据可靠性：
- 数据存储：答题数据、成绩数据、用户数据永久存储，支持数据冗余备份（主从数据库同步，同步延迟≤1 秒）。
- 备份策略：每日凌晨 2 点全量备份 MySQL 数据库（备份文件压缩加密存储，保留 30 天），每 6 小时增量备份（保留 7 天），备份文件存储在异地服务器（距离主服务器≥100 公里）。
- 数据校验：每次备份后自动校验数据完整性（MD5 校验），校验失败立即重试备份并发送告警通知（管理员短信 + 邮箱）。
- 异常处理：
- 网络异常：考生答题时网络中断，重新连接后可恢复答题进度（缓存有效期 30 分钟），未提交数据不丢失。
- 服务器异常：单台应用服务器故障，负载均衡自动切换至备用服务器（切换时间≤3 秒），用户无感知。
- 数据库异常：主数据库故障，自动切换至从数据库（切换时间≤5 秒），切换后数据正常读写。

### 3.3 安全性需求

- 数据加密：
- 存储加密：用户密码采用 Bcrypt 算法加密（10 位盐值），手机号 / 邮箱采用 AES-256 算法加密存储（密钥定期轮换，每 90 天一次），主观题答案等敏感数据存储时脱敏（如显示前 3 位 +\*\*\*\*）。
- 传输加密：所有 HTTP 请求采用 HTTPS 协议加密（TLS 1.3 版本），API 接口请求需携带 “Token”（基于 JWT 生成，有效期 2 小时，包含用户 ID、角色、权限信息），Token 传输时加密。
- 攻击防护：
- 防 SQL 注入：后端使用 MyBatis-Plus 参数绑定（#{}），禁止直接拼接 SQL，输入内容过滤特殊字符（如 '、"、;）。
- 防 XSS 攻击：前端通过 Vue 的 v-text 指令过滤 HTML 标签，后端使用 Jsoup 工具清理用户输入的恶意脚本，答题区域禁止插入标签。
- 防 CSRF 攻击：所有表单提交携带 CSRF Token（随机生成，与 Session 绑定），Token 有效期 1 小时，每次请求校验 Token 有效性。
- 限流防护：API 接口采用 Redis 实现限流（如 “同一 IP 每分钟最多请求 60 次”“同一用户每秒最多提交 2 次答题请求”），限流后返回 “429 Too Many Requests”，并提示 “操作过于频繁，请稍后再试”。
- 日志安全：
- 操作日志：记录所有关键操作（用户登录、权限变更、试卷修改、成绩批改），日志内容含 “操作人、操作时间、操作内容、IP 地址、设备信息”，日志不可篡改（存储在只读目录，支持日志审计）。
- 安全日志：记录异常操作（登录失败、越权访问、SQL 注入尝试），异常次数≥5 次时触发告警（管理员短信 + 邮箱通知），并临时锁定账号（15 分钟后自动解锁）。

### 3.4 易用性需求

- 界面设计：
- 一致性：所有页面遵循统一设计规范（颜色、字体、按钮样式、导航位置），如 “提交” 按钮统一为蓝色，“取消” 按钮统一为灰色。
- 直观性：核心功能入口突出显示（如考生端 “我的考试” 入口在首页顶部），操作流程≤3 步（如 “进入考试→验证身份→答题”），复杂操作提供 “操作指引”（如组卷时显示 “点击此处设置题型规则”）。
- 响应式：支持 PC 端（分辨率≥1366×768）、平板端（分辨率≥1024×768），PC 端答题界面支持 “全屏模式”（隐藏浏览器导航栏，减少干扰），平板端适配触控操作（如增大选项点击区域）。
- 交互体验：
- 提示反馈：操作成功 / 失败均显示明确提示（如 “密码修改成功”“切屏次数已达上限”），提示时长 3 秒，支持手动关闭。
- 错误引导：表单提交错误时，标注错误字段（如手机号格式错误）并提供修改建议（如 “请输入 11 位手机号”），避免用户反复尝试。
- 帮助支持：每个功能页面提供 “帮助” 按钮（问号图标），点击显示 “功能说明”“常见问题”（如组卷页面帮助说明 “随机组卷规则设置方法”），支持在线客服入口（工作时间 9:00-18:00）。
- 浏览器兼容：支持 Chrome（80+）、Firefox（75+）、Edge（80+）、Safari（13+）主流浏览器，不支持 IE 浏览器（登录页提示 “建议使用 Chrome 浏览器以获得最佳体验”）。

### 3.5 可扩展性需求

- 功能扩展：
- 题型扩展：预留 “题型插件接口”，未来新增 “编程题”（支持代码编译运行）、“听力题”（支持音频播放）时，无需修改核心代码，仅需开发对应题型的 “选项存储模块”“判分模块”“前端展示模块”。
- 功能模块扩展：支持新增 “错题集模块”“学习推荐模块”，通过 Spring Boot 的自动装配机制集成，不影响现有功能。
- 集成扩展：
- 第三方集成：预留 API 接口（RESTful 风格），支持与企业 OA 系统（同步用户数据）、学校教务系统（同步班级 / 课程数据）、支付系统（对接付费考试）集成，接口文档提供详细参数说明、返回值示例、错误码定义。
- 单点登录（SSO）：支持集成企业 / 学校的 SSO 系统（如 CAS、OAuth2.0），用户通过 SSO 登录后自动同步至考试系统（无需重复注册）。
- 部署扩展：支持水平扩展（增加应用服务器节点），通过 Nginx 负载均衡分发请求，数据库支持主从分离（主库写，从库读），Redis 支持集群部署（提高缓存可用性），满足业务增长后的性能需求。

## 4. 数据需求

### 4.1 核心数据实体与字段设计

|实体名称|核心字段（字段名 / 类型 / 约束 / 说明）|关联实体|
| -----------------------------------------| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|用户表（sys\_user）|user\_id/BIGINT/ 主键 / 自增，账号唯一标识username/VARCHAR (50)/ 非空 / 唯一 / 登录账号password/VARCHAR (60)/ 非空 / Bcrypt 加密存储real\_name/VARCHAR (50)/ 非空 / 用户姓名role\_id/BIGINT/ 非空 / 关联角色表org\_id/BIGINT/ 非空 / 关联组织表phone/VARCHAR (20)/ 唯一 / AES 加密存储email/VARCHAR (100)/ 唯一 / AES 加密存储status/TINYINT/ 非空 / 0 - 禁用，1 - 启用create\_time/DATETIME/ 非空 / 创建时间last\_login\_time/DATETIME/ 可空 / 最后登录时间|角色表（sys\_role）组织表（sys\_org）|
|角色表（sys\_role）|role\_id/BIGINT/ 主键 / 自增role\_name/VARCHAR (50)/ 非空 / 唯一 / 角色名称（如 “教师”）role\_desc/VARCHAR (200)/ 可空 / 角色描述create\_user\_id/BIGINT/ 非空 / 关联用户表（创建人）create\_time/DATETIME/ 非空 / 创建时间is\_default/TINYINT/ 非空 / 0 - 自定义，1 - 预设（不可删除）|用户表（sys\_user）|
|权限表（sys\_permission）|perm\_id/BIGINT/ 主键 / 自增perm\_name/VARCHAR (100)/ 非空 / 唯一 / 权限名称（如 “试卷\_发布”）perm\_type/TINYINT/ 非空 / 1 - 资源级，2 - 操作级resource\_code/VARCHAR (50)/ 可空 / 资源标识（如 “exam” 代表考试资源）perm\_code/VARCHAR (50)/ 非空 / 唯一 / 权限编码（如 “EXAM\_PUBLISH”）create\_time/DATETIME/ 非空 / 创建时间|角色权限关联表（sys\_role\_perm）|
|角色权限关联表（sys\_role\_perm）|id/BIGINT/ 主键 / 自增role\_id/BIGINT/ 非空 / 关联角色表perm\_id/BIGINT/ 非空 / 关联权限表|角色表（sys\_role）权限表（sys\_permission）|
|组织表（sys\_org）|org\_id/BIGINT/ 主键 / 自增org\_name/VARCHAR (100)/ 非空 / 唯一 / 组织名称（如 “XX 学校”）org\_level/TINYINT/ 非空 / 1 - 一级，2 - 二级（如学校→班级）parent\_id/BIGINT/ 可空 / 父组织 ID（顶级组织为 0）create\_time/DATETIME/ 非空 / 创建时间|用户表（sys\_user）|
|知识点表（question\_knowledge）|knowledge\_id/BIGINT/ 主键 / 自增knowledge\_name/VARCHAR (100)/ 非空 / 知识点名称（如 “CPU”）parent\_id/BIGINT/ 可空 / 父知识点 ID（顶级为 0）org\_id/BIGINT/ 非空 / 关联组织表（数据隔离）create\_time/DATETIME/ 非空 / 创建时间|题目表（question）|
|题目表（question）|question\_id/BIGINT/ 主键 / 自增question\_content/LONGTEXT/ 非空 / 题目内容（富文本）question\_type/TINYINT/ 非空 / 1 - 单选，2 - 多选，3 - 不定项，4 - 判断，5 - 匹配，6 - 排序，7 - 填空，8 - 主观knowledge\_ids/VARCHAR (100)/ 可空 / 关联知识点 ID（用 “,” 分隔）difficulty/TINYINT/ 非空 / 1 - 易，2 - 中，3 - 难score/DECIMAL (5,1)/ 非空 / 题目分值（如 2.0）answer\_list/VARCHAR (500)/ 可空 / 填空题答案（用 “|” 分隔）reference\_answer/LONGTEXT/ 可空 / 主观题参考答案score\_rule/VARCHAR (500)/ 可空 / 主观题评分标准create\_user\_id/BIGINT/ 非空 / 关联用户表（创建人）org\_id/BIGINT/ 非空 / 关联组织表audit\_status/TINYINT/ 非空 / 0 - 草稿，1 - 待审核，2 - 已通过，3 - 已拒绝status/TINYINT/ 非空 / 0 - 禁用，1 - 启用create\_time/DATETIME/ 非空 / 创建时间update\_time/DATETIME/ 可空 / 修改时间|
|选项表（question\_option）|option\_id/BIGINT/ 主键 / 自增question\_id/BIGINT/ 非空 / 关联题目表（外键，级联删除）option\_seq/VARCHAR (10)/ 非空 / 选项序号（如 A、1、题干 1）option\_content/LONGTEXT/ 非空 / 选项内容is\_correct/TINYINT/ 可空 / 0 - 错误，1 - 正确（单选 / 多选用）score\_ratio/TINYINT/ 可空 / 分值占比（0-100，不定项用）assoc\_flag/VARCHAR (10)/ 可空 / 关联标识（匹配题用，如 M1）correct\_order/INT/ 可空 / 正确排序值（排序题用）option\_analysis/VARCHAR (500)/ 可空 / 选项解析create\_time/DATETIME/ 非空 / 创建时间|题目表（question）|
|试卷表（paper）|paper\_id/BIGINT/ 主键 / 自增paper\_name/VARCHAR (200)/ 非空 / 试卷名称paper\_type/TINYINT/ 非空 / 1 - 固定，2 - 随机total\_score/DECIMAL (5,1)/ 非空 / 试卷总分pass\_score/DECIMAL (5,1)/ 非空 / 及格线org\_id/BIGINT/ 非空 / 关联组织表create\_user\_id/BIGINT/ 非空 / 关联用户表（创建人）audit\_status/TINYINT/ 非空 / 0 - 草稿，1 - 待审核，2 - 已通过，3 - 已拒绝publish\_status/TINYINT/ 非空 / 0 - 未发布，1 - 已发布，2 - 已过期allow\_analysis/TINYINT/ 非空 / 0 - 不允许，1 - 允许（查看错题解析）allow\_reexam/TINYINT/ 非空 / 0 - 不允许，1 - 允许（补考）reexam\_limit/INT/ 非空 / 0-5（补考次数限制）valid\_days/INT/ 非空 / 发布后有效天数（默认 30）create\_time/DATETIME/ 非空 / 创建时间publish\_time/DATETIME/ 可空 / 发布时间|用户表（sys\_user）组织表（sys\_org）试卷题目关联表（paper\_question）|
|试卷题目关联表（paper\_question）|id/BIGINT/ 主键 / 自增paper\_id/BIGINT/ 非空 / 关联试卷表（级联删除）question\_id/BIGINT/ 非空 / 关联题目表question\_score/DECIMAL (5,1)/ 非空 / 该题在试卷中的分值question\_order/INT/ 非空 / 题目在试卷中的顺序（固定组卷用）rule\_id/BIGINT/ 可空 / 关联组卷规则表（随机组卷用）|试卷表（paper）题目表（question）组卷规则表（paper\_rule）|
|组卷规则表（paper\_rule）|rule\_id/BIGINT/ 主键 / 自增paper\_id/BIGINT/ 非空 / 关联试卷表（级联删除）question\_type/TINYINT/ 非空 / 题型（同题目表）total\_num/INT/ 非空 / 该题型总题量easy\_num/INT/ 非空 / 易难度题量medium\_num/INT/ 非空 / 中难度题量hard\_num/INT/ 非空 / 难难度题量single\_score/DECIMAL (5,1)/ 非空 / 每题分值|试卷表（paper）|
|考试表（exam）|exam\_id/BIGINT/ 主键 / 自增exam\_name/VARCHAR (200)/ 非空 / 考试名称paper\_id/BIGINT/ 非空 / 关联试卷表start\_time/DATETIME/ 非空 / 考试开始时间end\_time/DATETIME/ 非空 / 考试结束时间exam\_duration/INT/ 非空 / 考试时长（分钟）cut\_screen\_num/TINYINT/ 非空 / 允许切屏次数（0-5）cut\_screen\_timer/TINYINT/ 非空 / 0 - 不计入，1 - 计入（切屏时长）forbid\_copy/TINYINT/ 非空 / 0 - 允许，1 - 禁止（复制粘贴）single\_device/TINYINT/ 非空 / 0 - 允许，1 - 禁止（多设备登录）anti\_plagiarism/TINYINT/ 非空 / 0 - 关闭，1 - 开启（主观题防抄袭）plagiarism\_threshold/TINYINT/ 可空 / 相似度阈值（0-100，开启防抄袭用）remind\_time/TINYINT/ 非空 / 考前提醒时间（分钟，0-60）create\_user\_id/BIGINT/ 非空 / 关联用户表（创建人）exam\_status/TINYINT/ 非空 / 0 - 未开始，1 - 进行中，2 - 已结束，3 - 已终止create\_time/DATETIME/ 非空 / 创建时间|试卷表（paper）用户表（sys\_user）考试考生关联表（exam\_user）|
|考试考生关联表（exam\_user）|id/BIGINT/ 主键 / 自增exam\_id/BIGINT/ 非空 / 关联考试表（级联删除）user\_id/BIGINT/ 非空 / 关联用户表exam\_status/TINYINT/ 非空 / 0 - 未参考，1 - 参考中，2 - 已提交，3 - 缺考reexam\_count/INT/ 非空 / 已补考次数（默认 0）final\_score/DECIMAL (5,1)/ 可空 / 最终成绩pass\_status/TINYINT/ 可空 / 0 - 不及格，1 - 及格（成绩出来后设置）create\_time/DATETIME/ 非空 / 创建时间|考试表（exam）用户表（sys\_user）答题记录表（answer\_record）|
|答题记录表（answer\_record）|record\_id/BIGINT/ 主键 / 自增exam\_id/BIGINT/ 非空 / 关联考试表（级联删除）user\_id/BIGINT/ 非空 / 关联用户表question\_id/BIGINT/ 非空 / 关联题目表option\_ids/VARCHAR (100)/ 可空 / 选择的选项 ID（用 “,” 分隔，客观题用）user\_answer/LONGTEXT/ 可空 / 考生答案（主观题 / 填空题用）score/DECIMAL (5,1)/ 可空 / 该题得分is\_marked/TINYINT/ 非空 / 0 - 未标记，1 - 标记（答题时标记）answer\_time/DATETIME/ 可空 / 答题时间correct\_answer/LONGTEXT/ 可空 / 标准答案（客观题，成绩查询用）comment/VARCHAR (500)/ 可空 / 批改评语（主观题用）|考试表（exam）用户表（sys\_user）题目表（question）|
|操作日志表（sys\_operate\_log）|log\_id/BIGINT/ 主键 / 自增user\_id/BIGINT/ 非空 / 关联用户表operate\_type/VARCHAR (50)/ 非空 / 操作类型（如 “新增”“修改”“删除”）operate\_content/VARCHAR (1000)/ 非空 / 操作内容（如 “修改试卷 P20251106001 的及格线”）ip\_address/VARCHAR (50)/ 可空 / 操作 IP 地址device\_info/VARCHAR (200)/ 可空 / 设备信息（如浏览器型号）operate\_time/DATETIME/ 非空 / 操作时间|用户表（sys\_user）|

### 4.2 数据关系与索引设计

#### 4.2.1 数据关系（ER 图核心关联）

- 一对多关系：
- 组织表（sys\_org）→用户表（sys\_user）：1 个组织包含多个用户，通过org\_id关联。
- 角色表（sys\_role）→用户表（sys\_user）：1 个角色包含多个用户，通过role\_id关联。
- 题目表（question）→选项表（question\_option）：1 道题目包含多个选项，通过question\_id关联（级联删除）。
- 试卷表（paper）→试卷题目关联表（paper\_question）：1 份试卷包含多个题目关联记录，通过paper\_id关联（级联删除）。
- 考试表（exam）→考试考生关联表（exam\_user）：1 场考试包含多个考生关联记录，通过exam\_id关联（级联删除）。
- 考试表（exam）→答题记录表（answer\_record）：1 场考试包含多个答题记录，通过exam\_id关联（级联删除）。
- 多对多关系：
- 角色表（sys\_role）→权限表（sys\_permission）：通过角色权限关联表（sys\_role\_perm）实现，1 个角色包含多个权限，1 个权限可分配给多个角色。
- 试卷表（paper）→题目表（question）：通过试卷题目关联表（paper\_question）实现，1 份试卷包含多个题目，1 道题目可被多个试卷引用。

#### 4.2.2 索引设计（优化查询性能）

|表名|索引类型|索引字段|索引用途|
| ---------------------| ----------| ------------------------------------------------------| -----------------------------------------------|
|sys\_user|唯一索引|username, phone, email|快速查询用户（登录、手机号 / 邮箱唯一性校验）|
|sys\_user|普通索引|role\_id, org\_id, status|按角色 / 组织 / 状态筛选用户|
|question|普通索引|question\_type, difficulty, org\_id|按题型 / 难度 / 组织筛选题目|
|question|普通索引|audit\_status, status|筛选 “已通过审核且启用” 的题目|
|question\_option|联合索引|question\_id, is\_correct|快速查询某题的正确选项（自动判分用）|
|question\_option|联合索引|question\_id, assoc\_flag|快速查询匹配题的关联选项|
|paper|普通索引|paper\_type, audit\_status, publish\_status|筛选 “已通过审核且已发布” 的试卷|
|exam|普通索引|paper\_id, exam\_status, start\_time|筛选 “进行中” 的考试，按试卷关联查询|
|exam\_user|联合索引|exam\_id, user\_id|快速查询某考生某场考试的状态|
|exam\_user|普通索引|exam\_status, final\_score|按考试状态 / 分数筛选考生（成绩统计用）|
|answer\_record|联合索引|exam\_id, user\_id, question\_id|快速查询某考生某场考试某题的答题记录|
|answer\_record|普通索引|score, is\_marked|筛选 “标记题目”“得分题”（成绩分析用）|

### 4.3 数据备份与恢复

#### 4.3.1 备份策略

- 全量备份：
- 执行时间：每日凌晨 2:00-4:00（系统低峰期），自动执行。
- 备份内容：MySQL 所有业务表数据（含用户表、题目表、答题记录表等），排除日志表（如 sys\_operate\_log，单独备份）。
- 存储方式：备份文件采用tar.gz压缩（压缩率≥60%），使用 AES-256 加密（密钥存储在加密服务器），备份文件命名格式为 “exam\_system\_full\_backup\_YYYYMMDD.tar.gz”，存储在主服务器本地 + 异地服务器（阿里云 OSS，保留 30 天）。
- 增量备份：
- 执行时间：每 6 小时一次（8:00、14:00、20:00、2:00，与全量备份错开），自动执行。
- 备份内容：基于上一次全量 / 增量备份后的数据变更（通过 MySQL 的 binlog 日志），仅备份变更数据。
- 存储方式：备份文件命名格式为 “exam\_system\_incremental\_backup\_YYYYMMDD\_HHMM.tar.gz”，存储在主服务器本地，保留 7 天。
- 日志备份：
- 执行时间：每日凌晨 1:00，自动执行。
- 备份内容：操作日志表（sys\_operate\_log）、安全日志表数据，按日期分区备份。
- 存储方式：备份文件存储在异地服务器，保留 1 年（合规要求）。

#### 4.3.2 恢复机制

- 恢复流程：

1. 恢复准备：确认恢复目标（如 “恢复 2025-11-05 10:00 的数据”），选择对应的全量备份 + 增量备份文件，停止应用服务（防止数据写入）。
2. 数据恢复：

- 全量恢复：解压全量备份文件，通过mysql命令导入全量数据（mysql -u root -p exam\_system \< full\_backup.sql）。
- 增量恢复：解析增量备份的 binlog 日志，应用数据变更（mysqlbinlog incremental\_binlog.000001 | mysql -u root -p exam\_system）。

3. 数据校验：恢复后执行校验脚本，检查核心表数据完整性（如 “用户表总记录数与备份前一致”“答题记录表总分计算正确”），校验失败则回滚到恢复前状态。
4. 服务启动：校验通过后，启动应用服务，监控系统运行状态（如 API 接口响应、数据库连接），确保恢复成功。

- 应急恢复：若主服务器故障，启用备用服务器，从异地备份下载最新全量备份文件，10 分钟内完成恢复，保障业务连续性。

## 5. 约束条件

### 5.1 技术约束

#### 5.1.1 后端技术栈

- 基础框架：
- JDK：11+（推荐 AdoptOpenJDK 11），需兼容 Java 8 语法（便于团队过渡）。
- Spring Boot：2.7.x（稳定版，避免使用快照版），集成 Spring Web、Spring Validation（参数校验）。
- Spring Security：5.7.x，实现认证（基于 JWT）、授权（RBAC 模型）、方法级权限校验（@PreAuthorize）。
- MyBatis-Plus：3.5.x，简化数据库操作，支持分页查询（PageHelper）、逻辑删除、批量操作（saveBatch）。
- 数据存储：
- MySQL：8.0.x（支持 JSON 字段、事务隔离级别 READ-COMMITTED，默认开启 InnoDB 引擎），配置innodb\_buffer\_pool\_size为服务器内存的 50%（优化查询性能）。
- Redis：6.0.x，用于缓存用户权限（sys\_user:{user\_id}:perms）、答题临时数据（exam:{exam\_id}:user:{user\_id}:answers）、限流计数（rate\_limit:{ip}:{api}），采用 Redis Cluster 集群部署（3 主 3 从）。
- 中间件与工具：
- Maven：3.6.x，项目构建工具，统一管理依赖版本（通过 parent pom）。
- Lombok：1.18.x，简化实体类代码（@Data、@NoArgsConstructor）。
- Hutool：5.8.x，工具类库（日期处理、加密解密、集合操作）。
- JWT：0.11.x，生成用户登录 Token（包含 user\_id、role\_id、expires\_at，密钥定期轮换）。
- EasyExcel：3.2.x，处理 Excel 导入导出（题目批量导入、成绩导出），支持大数据量（≤10 万条）处理。
- 接口规范：
- API 风格：RESTful，URL 采用 “资源 / 操作” 格式（如GET /api/v1/exams/{examId}查询考试），HTTP 方法对应操作（GET - 查询，POST - 新增，PUT - 修改，DELETE - 删除）。
- 响应格式：统一 JSON 格式，包含code（状态码，200 - 成功，400 - 参数错误，401 - 未登录，403 - 无权限，500 - 服务器错误）、msg（提示信息）、data（响应数据）。

#### 5.1.2 前端技术栈

- 基础框架：
- Vue：3.2.x（Composition API，使用\<script setup\>语法），核心框架，支持组件化开发。
- Vue Router：4.1.x，路由管理，实现路由守卫（登录校验beforeEach）、路由懒加载（() \=\> import('@/views/Exam.vue')）。
- Pinia：2.0.x，状态管理，存储用户信息（userStore）、全局配置（configStore），支持持久化存储（pinia-plugin-persistedstate）。
- UI 组件库：
- Element Plus：2.3.x，适配 Vue 3 的 UI 组件库，用于构建管理端（教师 / 管理员）界面（表格、表单、弹窗、图表）。
- Vant：4.0.x，移动端 UI 组件库，用于构建考生端平板适配界面（按钮、输入框、下拉框）。
- 构建与工具：
- Vite：2.9.x，前端构建工具，比 Webpack 更快的热更新、打包速度，配置多环境（开发、测试、生产）。
- Axios：1.3.x，HTTP 请求库，封装请求拦截器（添加 Token）、响应拦截器（统一处理错误）。
- ECharts：5.4.x，可视化图表库，用于展示成绩分布、知识点掌握率（柱状图、饼图、折线图）。
- Quill：2.0.x，富文本编辑器，用于题目内容编辑（支持插入图片、公式）、主观题答题（支持插入图片）。
- 兼容性：
- 浏览器：支持 Chrome 80+、Firefox 75+、Edge 80+、Safari 13+，不支持 IE（登录页提示兼容浏览器列表）。
- 分辨率：PC 端最小分辨率 1366×768，平板端最小分辨率 1024×768，适配响应式布局（使用 Flex、Grid 布局）。

#### 5.1.3 部署环境

- 服务器配置：
- 应用服务器：2 核 4G 内存，50G SSD 存储（最低配置），高并发场景（≥1000 人同时在线）需 4 核 8G 内存，支持水平扩展（增加节点）。
- 数据库服务器：4 核 8G 内存，100G SSD 存储（MySQL 主从分离，主库 4 核 8G，从库 2 核 4G），开启 binlog 日志（用于增量备份）。
- Redis 服务器：2 核 4G 内存，30G SSD 存储（Redis Cluster 6 节点，3 主 3 从）。
- 操作系统：
- 应用服务器 / Redis 服务器：Linux CentOS 7.9.x（稳定版，支持 systemd 服务管理），关闭不必要的服务（如 iptables，使用云服务器安全组）。
- 数据库服务器：Linux Ubuntu 20.04.x（LTS 版，对 MySQL 支持友好）。
- 中间件部署：
- Nginx：1.20.x，部署在应用服务器前端，负责静态资源（前端 Vue 打包文件）分发、API 请求反向代理、负载均衡（多应用服务器节点），配置 HTTPS（SSL 证书通过 Let's Encrypt 申请）。
- 监控工具：Prometheus + Grafana，监控服务器 CPU、内存、磁盘使用率，数据库连接数、QPS，Redis 缓存命中率，系统异常时发送告警（管理员短信 + 邮箱）。

### 5.2 合规约束

- 个人信息保护：
- 符合《中华人民共和国个人信息保护法》，用户手机号、邮箱、身份证号等敏感信息加密存储（AES-256），仅管理员可查看（需开启 “敏感信息查看” 权限，操作记录日志）。
- 用户可申请 “个人信息导出”（含账号、姓名、成绩等）、“账号注销”（注销后 7 天内删除所有个人数据，备份数据中匿名化处理）。
- 数据留存：
- 考试数据（试卷、答题记录、成绩）默认留存 3 年，管理员可设置留存周期（最长 10 年），超过留存周期自动匿名化处理（删除用户标识，仅保留题目、答案、得分）。
- 操作日志、安全日志留存 1 年，用于审计追溯，1 年后自动归档（压缩存储，保留 3 年）。
- 权限合规：
- 权限分配遵循 “最小必要原则”（如 “阅卷教师” 仅分配 “主观题批改” 权限，无 “删除考试” 权限），禁止超范围分配权限。
- 定期权限审计（每季度一次），检查 “冗余权限”（如离职用户未删除权限）、“越权配置”（如考生拥有教师权限），审计报告提交管理员签字确认。
- 考试公平性：
- 防作弊功能需明确告知考生（考试规则中注明 “切屏超过 3 次自动提交”），避免暗箱操作。
- 主观题防抄袭检测结果需人工复核，不可直接判定作弊（防止误判），作弊处理需告知考生原因，并允许申诉（3 个工作日内回复）。

## 6. 优先级说明

|需求级别|定义|覆盖范围（含核心功能与技术实现）|交付时间要求（示例）|
| ------------| --------------------------| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| -------------------------|
|P0（必须）|核心功能，无则系统不可用|1. 用户管理：账号 CRUD、Bcrypt 密码加密、Spring Security 基础权限（角色分配）2. 题库管理：单选 / 多选题维护、选项表设计与关联、题目审核3. 试卷管理：固定组卷、试卷审核4. 考试管理：考试创建、基础答题（客观题）、自动提交5. 成绩管理：客观题自动判分、考生成绩查询6. 技术实现：MySQL 表创建、Spring Boot+Vue 基础框架搭建、HTTP 接口开发|项目启动后 4 周内交付|
|P1（重要）|核心流程补充，影响体验|1. 用户管理：权限细粒度控制（操作级权限）、密码重置2. 题库管理：多题型支持（不定项 / 匹配 / 排序 / 填空 / 主观题）、题目批量导入 / 导出3. 试卷管理：随机组卷、试卷版本管理4. 考试管理：防作弊（切屏检测 / 单设备登录）、定时发布 / 紧急终止5. 成绩管理：主观题批改、成绩汇总统计6. 技术实现：Redis 缓存（答题数据 / 权限）、Excel 导入导出（EasyExcel）|项目启动后 6 周内交付|
|P2（可选）|优化扩展功能，提升效率|1. 用户管理：SSO 集成、账号禁用 / 解锁2. 题库管理：选项解析编辑、题目使用统计3. 试卷管理：补考设置、试卷有效期4. 考试管理：主观题防抄袭、考试监控5. 成绩管理：成绩导出（图表 + 数据）、成绩重判6. 技术实现：Prometheus 监控、API 限流、异地备份|项目启动后 8 周内交付|
|P3（远期）|增值功能，提升竞争力|1. 题库管理：编程题 / 听力题支持、题目 AI 推荐2. 考试管理：人脸识别验证、直播监考3. 成绩管理：成绩分析报告（AI 生成薄弱知识点）4. 系统集成：对接支付系统（付费考试）、证书系统（成绩达标发证书）|项目上线后 2 个月内迭代|
